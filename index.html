<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Advanced Data And Holdings - Professional stock management and sales tracking application">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ADAH">
    <meta name="msapplication-TileColor" content="#667eea">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180x180.png">
    <link rel="mask-icon" href="icons/icon.svg" color="#667eea">
    
    <!-- Splash Screens for iOS -->
    <link rel="apple-touch-startup-image" href="icons/splash-2048x2732.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/splash-1668x2388.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/splash-1536x2048.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    
    <title>ADAH - Advanced Data And Holdings</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1><i class="fas fa-boxes"></i> ADAH Stock Management tool</h1>
            <div class="header-stats">
                <div class="stat-item">
                    <span class="stat-label">Total Stock Value:</span>
                    <span id="totalStockValue" class="stat-value">$0.00</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Gross Revenue:</span>
                    <span id="grossRevenue" class="stat-value">$0.00</span>
                </div>
                <div class="stat-item net-revenue-highlight">
                    <span class="stat-label">Net Revenue:</span>
                    <span id="netRevenue" class="stat-value net-revenue-value">$0.00</span>
                    <div class="revenue-indicator" id="revenueIndicator">
                        <i class="fas fa-chart-line"></i>
                        <span class="revenue-status">Real-time</span>
                    </div>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Total Debt:</span>
                    <span id="totalDebt" class="stat-value">$0.00</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <button class="nav-btn active" data-tab="stock">
                <i class="fas fa-warehouse"></i> Stock
            </button>
            <button class="nav-btn" data-tab="sales">
                <i class="fas fa-shopping-cart"></i> Sales
            </button>
            <button class="nav-btn" data-tab="customers">
                <i class="fas fa-users"></i> Customers
            </button>
            <button class="nav-btn" data-tab="reports">
                <i class="fas fa-chart-bar"></i> Reports
            </button>
            <button class="nav-btn" data-tab="analytics">
                <i class="fas fa-analytics"></i> Analytics
            </button>
        </div>
    </nav>

    <!-- Search Bar -->
    <div class="search-container">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Search stock items, sales, or customers...">
            <button id="clearSearch" class="clear-btn"><i class="fas fa-times"></i></button>
        </div>
        <div id="searchResults" class="search-results"></div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Stock Tab -->
        <div id="stock-tab" class="tab-content active">
            <div class="tab-header">
                <h2>Stock Management</h2>
                <button id="addStockBtn" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Add Stock
                </button>
            </div>
            <div class="table-container">
                <table id="stockTable" class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Quantity</th>
                            <th>Price</th>
                            <th>Description</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="stockTableBody">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Sales Tab -->
        <div id="sales-tab" class="tab-content">
            <div class="tab-header">
                <h2>Sales Tracking</h2>
                <button id="addSaleBtn" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Add Sale
                </button>
            </div>
            <div class="table-container">
                <table id="salesTable" class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Date</th>
                            <th>Item</th>
                            <th>Quantity</th>
                            <th>Total</th>
                            <th>Customer</th>
                            <th>Phone</th>
                            <th>Status</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="salesTableBody">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Customers Tab -->
        <div id="customers-tab" class="tab-content">
            <div class="tab-header">
                <h2>Customer Management</h2>
                <button id="exportCustomersBtn" class="btn btn-secondary">
                    <i class="fas fa-file-pdf"></i> Export PDF
                </button>
            </div>
            <div class="table-container">
                <table id="customersTable" class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Phone</th>
                            <th>Total Purchases</th>
                            <th>Total Spent</th>
                            <th>Last Purchase</th>
                            <th>First Contact</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="customersTableBody">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports-tab" class="tab-content">
            <div class="tab-header">
                <h2>Reports & Exports</h2>
            </div>
            <div class="reports-grid">
                <div class="report-card">
                    <h3>Daily Sales Report</h3>
                    <input type="date" id="dailyReportDate" class="form-input">
                    <button id="generateDailyReport" class="btn btn-primary">
                        <i class="fas fa-file-pdf"></i> Generate PDF
                    </button>
                </div>
                <div class="report-card">
                    <h3>Weekly Sales Report</h3>
                    <input type="date" id="weeklyStartDate" class="form-input" placeholder="Start Date">
                    <input type="date" id="weeklyEndDate" class="form-input" placeholder="End Date">
                    <button id="generateWeeklyReport" class="btn btn-primary">
                        <i class="fas fa-file-pdf"></i> Generate PDF
                    </button>
                </div>
                <div class="report-card">
                    <h3>Monthly Sales Report</h3>
                    <select id="monthlyYear" class="form-input">
                        <option value="">Select Year</option>
                    </select>
                    <select id="monthlyMonth" class="form-input">
                        <option value="">Select Month</option>
                        <option value="1">January</option>
                        <option value="2">February</option>
                        <option value="3">March</option>
                        <option value="4">April</option>
                        <option value="5">May</option>
                        <option value="6">June</option>
                        <option value="7">July</option>
                        <option value="8">August</option>
                        <option value="9">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                    <button id="generateMonthlyReport" class="btn btn-primary">
                        <i class="fas fa-file-pdf"></i> Generate PDF
                    </button>
                </div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics-tab" class="tab-content">
            <div class="tab-header">
                <h2>Analytics & Insights</h2>
            </div>
            <div class="analytics-grid">
                <div class="chart-container">
                    <h3>Daily Sales Trend</h3>
                    <canvas id="dailySalesChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Top Selling Items</h3>
                    <canvas id="topItemsChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Monthly Revenue</h3>
                    <canvas id="monthlyRevenueChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Low Stock Alert</h3>
                    <div id="lowStockList" class="low-stock-list">
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <!-- Stock Modal -->
    <div id="stockModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="stockModalTitle">Add Stock Item</h3>
                <span class="close">&times;</span>
            </div>
            <form id="stockForm" class="modal-form">
                <input type="hidden" id="stockId">
                <div class="form-group">
                    <label for="stockName">Name *</label>
                    <input type="text" id="stockName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label for="stockQuantity">Quantity *</label>
                    <input type="number" id="stockQuantity" class="form-input" min="0" required>
                </div>
                <div class="form-group">
                    <label for="stockPrice">Price *</label>
                    <input type="number" id="stockPrice" class="form-input" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="stockDescription">Description</label>
                    <textarea id="stockDescription" class="form-input" rows="3"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelStockBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sale Modal -->
    <div id="saleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="saleModalTitle">Add Sale</h3>
                <span class="close">&times;</span>
            </div>
            <form id="saleForm" class="modal-form">
                <input type="hidden" id="saleId">
                <div class="form-group">
                    <label for="saleItem">Item *</label>
                    <select id="saleItem" class="form-input" required>
                        <option value="">Select an item</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="saleQuantity">Quantity *</label>
                    <input type="number" id="saleQuantity" class="form-input" min="1" required>
                </div>
                <div class="form-group">
                    <label for="saleCustomer">Customer</label>
                    <input type="text" id="saleCustomer" class="form-input">
                </div>
                <div class="form-group">
                    <label for="salePhone">Phone (10 digits starting with 07)</label>
                    <input type="tel" id="salePhone" class="form-input" pattern="07[0-9]{8}">
                </div>
                <div class="form-group">
                    <label for="salePaid">Payment Status</label>
                    <select id="salePaid" class="form-input">
                        <option value="1">Paid</option>
                        <option value="0">Debt</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelSaleBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Scripts -->
    <script src="database.js"></script>
    <script src="app.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        // Enhanced modal focus and scroll management
        function setupModalFocus() {
            // Close modal on escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    const openModal = document.querySelector('.modal.modal-open');
                    if (openModal) {
                        const closeBtn = openModal.querySelector('.close');
                        if (closeBtn) {
                            closeBtn.click();
                        }
                    }
                }
            });
        }
        
        // Initialize modal focus management
        setupModalFocus();
        
        // Register service worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
        

    </script>
    

</body>
</html>